# ä»VAEå’ŒGANè°ˆå˜åˆ†æ¨ç†å’Œé©¬å°”å¯å¤«è’™ç‰¹å¡ç½—é‡‡æ ·

> è¿™ä¸æ˜¯ä¸€ç¯‡ç§‘æ™®æ–‡ç« ï¼Œç”¨å‡ ä¸ªå½¢è±¡çš„æ¯”å–»è§£é‡Šæ¦‚å¿µå°±ç»“æŸäº†ï¼Œåšå¥½å‡†å¤‡å»çœŸæ­£ç†è§£æ•°å­¦å…¬å¼ï¼Œä¸åŒæ–¹æ³•é—´çš„è”ç³»å’ŒåŒºåˆ«ä¹Ÿå°±æ˜¾è€Œæ˜“è§äº†ã€‚
>
> å¦æ³¨å˜åˆ†æ¨ç†ç”¨äºè´å¶æ–¯ä¼°è®¡å’Œæœºå™¨å­¦ä¹ é¢†åŸŸä¸­çš„è¿‘ä¼¼è®¡ç®—å¤æ‚ç§¯åˆ†åˆ™ç§°å˜åˆ†è´å¶æ–¯æ¨ç†(Variational Bayesian Inference)ï¼Œå®ƒå…³æ³¨çš„å¦‚ä½•æ±‚è§£ä¸€ä¸ªè¿‘ä¼¼åéªŒæ¦‚ç‡åˆ†å¸ƒã€‚

- [ ] (å…¨æ–‡å¯¹åº”ä¸åŒåˆ†å¸ƒçš„æŒ‡ä»£éœ€è¦åŒæ­¥)
- [ ] å¯¹æ•°æ®é©±åŠ¨æ–¹æ³•çš„æ¨¡å‹æ•´ç†

å˜åˆ†è‡ªç¼–ç å™¨(VAE)å’Œå¯¹æŠ—ç”Ÿæˆç½‘ç»œ(GAN)æ˜¯å…¸å‹çš„æ·±åº¦ç”Ÿæˆæ¨¡å‹ï¼Œè¿™ç±»**ç”Ÿæˆæ¨¡å‹**é€šå¸¸è¢«å‚æ•°åŒ–ä¸ºä¸€ä¸ªæ·±åº¦ç¥ç»ç½‘ç»œï¼š

- VAE

  VAEå‡å®šä¸€ä¸ªæ˜¾å¼çš„ç”Ÿæˆæ¨¡å‹:
  $$
  x\sim p(x|z;\theta), z\sim p(z)
  $$
  $x$æ˜¯ä»æ˜¾å¼ç”Ÿæˆåˆ†å¸ƒ$p(x|z;\theta)$ä¸Šé‡‡æ ·å¾—åˆ°ï¼Œå¯ä»¥æ˜¾å¼çš„è®¡ç®—$x$çš„ä¼¼ç„¶åº¦ã€‚

- GAN

  GANå‡å®šä¸€ä¸ªéšå¼ç”Ÿæˆæ¨¡å‹ï¼Œé€šè¿‡ä¸‹å¼ç”Ÿæˆä¸€ä¸ªæ ·æœ¬ï¼š
  $$
  x=G(z;\theta), z\sim p(z)
  $$
  å³é¦–å…ˆä»å…ˆéªŒåˆ†å¸ƒ$p(z)$ä¸Šé‡‡æ ·$z$,ç„¶åé€šè¿‡ç¥ç»ç½‘ç»œ$G(\theta)$å°†$z$è¿›è¡Œå˜æ¢ï¼Œå¹¶è¾“å‡ºæœ€åçš„æ ·æœ¬$x$,ä¸Šå¼å®é™…å®šä¹‰äº†å¯¹$x$çš„åˆ†å¸ƒ$p(x;\theta)$ã€‚

ç°åœ¨æœ€åŸºæœ¬çš„ç›®æ ‡å½“ç„¶æ˜¯ä¸¤ç§ç”Ÿæˆæ¨¡å‹çš„å‚æ•°å¦‚ä½•ç¡®å®šï¼Œå…ˆæ¥çœ‹äºŒè€…å­¦ä¹ ç”Ÿæˆå‚æ•°$\theta$çš„å·®å¼‚ï¼š

- VAE

  VAEé¢å¤–çš„å­¦ä¹ ä¸€ä¸ªå˜åˆ†åˆ†å¸ƒ$q(z|x;\phi)$(ç¼–ç å™¨)ï¼Œå®ƒæ˜¯çœŸå®åéªŒæ¦‚ç‡åˆ†å¸ƒ$p(z|x;\theta)$çš„è¿‘ä¼¼ï¼Œä¸”æ­£æ¯”äº$p(x|z;\theta)p(z)$ï¼›æœ€ç»ˆçš„ç›®æ ‡è½¬åŒ–ä¸ºè®­ç»ƒæ¥æœ€å°åŒ–å˜åˆ†åˆ†å¸ƒå’ŒçœŸå®åéªŒåˆ†å¸ƒä¹‹é—´çš„KLæ•£åº¦ï¼š$KL(q(z|x;\phi)||p(z|x;\theta))$ã€‚

- GAN

  é€šè¿‡è®¾ç½®ä¸€ä¸ªå¯¹æŠ—åšå¼ˆï¼Œå°†ç”Ÿæˆå™¨$p(x;\theta)$å’Œåˆ¤åˆ«å™¨$q(\phi_i)$($\phi$è¢«å›ºå®šä¸ºæŸä¸ªå€¼$\phi_i$)é…å¯¹ï¼Œå…¶ä¸­åˆ¤åˆ«å™¨è¢«å¯»æ¥å‘¢åˆ†è¾¨çœŸå®æ•°æ®å’Œç”Ÿæˆæ ·æœ¬ï¼Œè€Œç”Ÿæˆå™¨è¢«è®­ç»ƒç”Ÿæˆå¯ä»¥æ¬ºéª—åˆ¤åˆ«å™¨çš„æ ·æœ¬ã€‚

> $G(z;\theta)$è¡¨ç¤ºå‡½æ•°å…³ç³»ï¼ŒGçš„ç»“æœæ˜¯ç”±æ•°å€¼zå’Œå˜é‡$\theta$å…±åŒç¡®å®šï¼Œæ³¨æ„åˆ†å·â€œ;â€çš„æ„ä¹‰ï¼Œåˆ†éš”çš„æ•°å€¼å’Œå˜é‡ï¼›
>
> $p(x;\theta)$è¡¨è¾¾åˆ†å¸ƒï¼Œè¡¨ç¤º$x$çš„åˆ†å¸ƒæ˜¯ç”±å‚æ•°$\theta$ç¡®å®šçš„ï¼›
>
> ä¸Šä¸€ç¯‡æ–‡ç« ä¸­æ›¾ç»å¼ºè°ƒè¿‡ç¬¦å·"|"çš„æ„ä¹‰,æ³¨æ„åŒºåˆ†è¡¨è¾¾çš„æ˜¯æ¡ä»¶æ¦‚ç‡è¿˜æ˜¯è¡¨è¾¾ä¼¼ç„¶æ€§ï¼Œä¸»è¦æ˜¯çœ‹"|"åé¢çš„å‚æ•°æ˜¯ä¸æ˜¯éšæœºå˜é‡(å—¯ï¼Œå…³äºéšæœºå˜é‡çš„è¯´æ³•ï¼Œé¢‘ç‡å­¦æ´¾å¯èƒ½å°±ä¸åŒæ„äº†ï¼Œè®¤ä¸ºæ˜¯å›ºå®šå‚æ•°)ã€‚

åœ¨å¾—åˆ°ä¼˜åŒ–å‚æ•°ç›®æ ‡å‡½æ•°çš„è¡¨è¾¾å¼ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£å˜åˆ†æ¨ç†ï¼Œè€Œå˜åˆ†æ¨ç†æœ¬èº«å’ŒMCMCä¹‹é—´æœ‰ç€å¯†åˆ‡çš„å…³ç³»ã€‚

åƒå¾€å¸¸ä¸€æ ·ï¼Œæˆ‘ä»¬ä»è´å¶æ–¯å…¬å¼å¼€å§‹ï¼š
$$
p(z|x) = \cfrac{p(x|z)p(z)}{p(x)}\tag{1}
$$
å¼•ç”¨ä¸€ä¸ªå¾ˆå¥½çš„è§£é‡Šï¼Œå¦‚æœé€šè¿‡$x \in R^D$ä¸Šçš„æ¦‚ç‡åˆ†å¸ƒå¯¹æ•´ä¸ªä¸–ç•Œå»ºæ¨¡ï¼Œå…¶ä¸­$p(x)$è¡¨ç¤º$x$å¯èƒ½å¤„äºçš„çŠ¶æ€ã€‚è¿™ä¸ªä¸–ç•Œå¯èƒ½éå¸¸çš„å¤æ‚ï¼Œæˆ‘ä»¬æ— æ³•çŸ¥é“$p(x)$çš„å…·ä½“å½¢å¼ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¼•å…¥å¦ä¸€ä¸ªå˜é‡$z\in R^d$æ¥æè¿°$x$çš„èƒŒæ™¯ä¿¡æ¯ï¼Œè¿™ä¸ªå˜é‡ä½¿å¾—æˆ‘ä»¬å¯ä»¥å°†$p(x)$è¡¨ç¤ºä¸ºä¸€ä¸ªæ— é™æ··åˆæ¨¡å‹ï¼š
$$
p(x) = \int p(x|z)p(z)dz\tag{2}
$$
å¯¹äº$z$çš„ä»»æ„å¯èƒ½ï¼Œéƒ½å¼•å…¥å¦ä¸€ä¸ªæ¡ä»¶åˆ†å¸ƒï¼Œå¹¶é€šè¿‡$z$çš„æ¦‚ç‡è¿›è¡ŒåŠ æƒï¼Œæœ€ç»ˆå¾—åˆ°$p(x)$å–å€¼ã€‚é‚£ä¹ˆåŸºäºä¸Šé¢è¿™æ ·çš„è®¾å®šï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦è§£å†³çš„é—®é¢˜å°±å˜æˆï¼šç»™å®š$x$çš„è§‚æµ‹å€¼ï¼Œéšå˜é‡$z$æ˜¯ä»€ä¹ˆï¼Œå³è´å¶æ–¯å…¬å¼çš„å·¦è¾¹â€”â€”åéªŒæ¦‚ç‡åˆ†å¸ƒ$p(z|x)$ã€‚



æ— è®ºæ˜¯è®¡ç®—åéªŒæ¦‚ç‡åˆ†å¸ƒ$p(z|x)$è¿˜æ˜¯è¾¹ç¼˜æ¦‚ç‡åˆ†å¸ƒ$p(x)$éƒ½éœ€è¦è®¡ç®—å¼$(2)$ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦çŸ¥é“ï¼Œç”±äº$x$å’Œ$z$çš„å–å€¼ç©ºé—´éƒ½éå¸¸å¤§ï¼Œé€šå¸¸æƒ…å†µæˆ‘ä»¬è®¤ä¸ºæ˜¯æ— æ³•ç›´æ¥è®¡ç®—çš„ï¼Œå› è€Œéœ€è¦é‡‡ç”¨è¿‘ä¼¼æ¨ç†è¿›è¡Œä¼°è®¡ã€‚



äº‹å®ä¸Šï¼Œæˆ‘ä»¬æœ‰å‡ ç§è¿‘ä¼¼è®¡ç®—å¤æ‚ç§¯åˆ†çš„æŠ€æœ¯å¯ä»¥å¯¹$p(x)$è¿›è¡Œä¼°è®¡ï¼Œè¿™é‡Œæˆ‘ä»¬é‡ç‚¹ä»‹ç»å’Œå¯¹æ¯”ä¸¤ç§æ–¹å¼ï¼Œå˜åˆ†æ¨ç†(**VI**ï¼Œvaritational inference)å’Œé©¬å°”å¯å¤«è’™ç‰¹å¡ç½—é‡‡æ ·(**MCMC**ï¼ŒMarokv Chain Monte Carlo)ã€‚

## VIå’ŒMCMC

åœ¨å¤æ‚çš„ç»Ÿè®¡æ¨¡å‹ä¸­ï¼Œæ¨¡å‹ä¸€èˆ¬åŒ…æ‹¬ä¸‰ç±»å˜é‡ï¼šè§‚æµ‹å˜é‡(observed variables, data)ï¼ŒæœªçŸ¥å‚æ•°ï¼ˆparametersï¼‰ï¼Œå’Œéšå˜é‡ï¼ˆlatent variablesï¼‰

### å˜åˆ†æ¨ç† vs MCMC

ä¸ç®¡æ˜¯å˜åˆ†æ¨ç†è¿˜æ˜¯MCMCæ–¹æ³•ï¼Œæœ€ç»ˆæœ¬è´¨ä¸Šéƒ½æ˜¯è§£å†³ä¸€ä¸ªä¼˜åŒ–é—®é¢˜ï¼š
$$
q_\phi^*(z|x)={arg\ min}_{q_\phi(z|x)\in D}KL({q_\phi(z|x)}||{p_\theta(z|x)})
$$
VIé€šè¿‡ä¼˜åŒ–æ¥è¿‘ä¼¼æ¦‚ç‡åˆ†å¸ƒï¼Œå¹¿æ³›åº”ç”¨äºä¼°è®¡**ä½¿ç”¨è´å¶æ–¯æ¨ç†ä¼°è®¡åéªŒæ¦‚ç‡åˆ†å¸ƒæ—¶**å‡ºç°çš„éš¾ä»¥è®¡ç®—çš„æ¦‚ç‡,æ¯”å¦‚ä¸Šé¢æåˆ°çš„$p(x)â€‹$ã€‚

é€šå¸¸æˆ‘ä»¬ä¹Ÿç”¨MCMCæ–¹æ³•æ¥è¿‘ä¼¼ï¼Œä½†æ˜¯å½“é¢å¯¹å¤§æ•°æ®é›†æˆ–è€…å¤æ‚æ¨¡å‹ï¼ŒMCMCéœ€è¦é‡‡æ ·å¤§é‡çš„æ ·æœ¬æ¥è¿›è¡Œå¯é çš„ä¼°è®¡ï¼Œä½†è¿™åœ¨æ•ˆç‡ä¸Šæ˜¯ä¸å¯æ¥å—çš„ã€‚

MCMCäº§ç”Ÿä¸ç›®æ ‡åˆ†å¸ƒä¸­æ¸è¿›çš„ç²¾ç¡®æ ·æœ¬ï¼Œé€‚åˆäºç²¾ç¡®æ¨ç†ï¼Œä½†æ˜¯è®¡ç®—é‡å¤§ï¼Œè®¡ç®—ç¼“æ…¢ï¼›VIè®¡ç®—æ›´å¿«ï¼Œåœ¨æ¢ç´¢å¤šåœºæ™¯å’Œå¤§æ•°æ®é›†ä¸‹æ›´å®ç”¨ã€‚

### å˜åˆ†æ¨ç†

> å®šä¹‰ï¼šä»å…³äº**éšå˜é‡çš„åˆ†å¸ƒæ—ä¸­**æ‰¾åˆ°ä¸€ä¸ªä¸çœŸå®åˆ†å¸ƒå·®å¼‚æœ€å°çš„åˆ†å¸ƒï¼Œè¿™ä¸ªåˆ†å¸ƒçš„å‚æ•°ç”¨ğ“?æ¥æ ‡è®°ï¼Œå³é€šè¿‡å¯»æ±‚æœ€å¯èƒ½æ¥è¿‘çœŸå®åˆ†å¸ƒçš„è¿‘ä¼¼åˆ†å¸ƒ$q$æ¥é€¼è¿‘çœŸå®åˆ†å¸ƒ$p$ã€‚

ç›¸æ¯”EMç®—æ³•ï¼ˆéšå˜é‡çš„æ¡ä»¶åˆ†å¸ƒåœ¨è¿­ä»£è¿‡ç¨‹ä¸­æ˜¯å¯ä»¥è®¡ç®—çš„ï¼‰ï¼ŒVIåˆ™ç”¨äºéšå˜é‡çš„æ¡ä»¶æ¦‚ç‡æ— æ³•è®¡ç®—çš„æ¨¡å‹

ä½¿ç”¨KLæ•£åº¦æè¿°ä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒpå’Œqçš„ç›¸ä¼¼ç¨‹åº¦:
$$
KL(q(z|x;\phi)||p(z|x;\theta)) = E_{q(z|x;\phi)}[log \cfrac{q(z|x;\phi)}{p(z|x;\theta)}]
$$


é€šè¿‡æœ€å°åŒ–KLæ•£åº¦å°±å¯ä»¥æ¨å¯¼å‡ºå˜åˆ†æ¨ç†çš„ELOB(Evidence Lower Bound)ï¼š
$$
\begin{split}
ELOB(q(z|x;\phi)) 
&= E_{q(z|x;\phi)}[log \cfrac{p(x,z;\theta)}{q(z|x;\phi)}]\\\\
&=E_{q(z|x;\phi)}[log\ {p(x,z;\theta)}] - \\\\
&E_{q(z|x;\phi)}[{log\ q(z|x;\phi)}]
\end{split}
$$
å¯ä»¥å¾—åˆ°ï¼š
$$
log\ p(x;\theta) = KL(q(z|x;\phi)||p(z|x;\theta)) + ELOB(q(z|x;\phi))
$$

è€ƒè™‘éšå˜é‡$z$ï¼Œé‚£ä¹ˆå·¦è¾¹æ˜¯ä¸$z$æ— å…³çš„å¸¸é‡ï¼Œç”±äºç›®æ ‡æ˜¯æœ€å°åŒ–ä¸¤ä¸ªåˆ†å¸ƒçš„KLæ•£åº¦ï¼Œå› æ­¤æœ€å°åŒ–$KL(q||p)$æ•£åº¦ç­‰ä»·äº**æœ€å¤§åŒ–**$ELOB(q)$ï¼Œç”±äºKLæ•£åº¦æ˜¯éè´Ÿçš„ï¼ˆå‚è§é™„å½•ä¿¡æ¯è®ºéƒ¨åˆ†ï¼‰ï¼Œå› æ­¤$ELOB(q)$æ˜¯$logp(x;\theta)$çš„ä¸‹ç•Œã€‚

ç°åœ¨éœ€è¦å…³å¿ƒçš„æ˜¯å¦‚ä½•æœ€å¤§åŒ–$ELOB(q)$ï¼Œæ—¢ç„¶æˆ‘ä»¬å·²ç»ç”¨$ELOB(q)$æŒ‡å®šäº†å˜åˆ†ç›®æ ‡å‡½æ•°ï¼Œé‚£ä¹ˆç°åœ¨éœ€è¦é€‰å–åˆ†å¸ƒçš„å˜åˆ†æ—ï¼Œä»ä¸­é€‰æ‹©è¿‘ä¼¼å˜åˆ†åˆ†å¸ƒã€‚ä¸€ä¸ªæ¯”è¾ƒé€šç”¨çš„å˜åˆ†æ—æ˜¯å¹³å‡åœºå˜åˆ†æ—(mean-field variational family)ã€‚å¹³å‡åœºå˜åˆ†æ—çš„å˜åˆ†åˆ†å¸ƒï¼Œ**éšå˜é‡é—´ç›¸äº’ç‹¬ç«‹**ï¼Œè€Œä¸”**æ¯ä¸€ä¸ªå˜é‡éƒ½å—ä¸€ä¸ªä¸åŒçš„å› ç´ æ”¯é…**ï¼Œå¹³å‡åœºå˜åˆ†æ—çš„ä¸€èˆ¬æˆå‘˜å¯è¡¨ç¤ºå¦‚ä¸‹ï¼š
$$
q(z) = \prod_{j=1}^m q_j(z_j)
$$
æˆ‘ä»¬å·²ç»æŒ‡å®šäº†ç›®æ ‡å‡½æ•°å’Œåˆ†å¸ƒçš„å˜åˆ†æ—ï¼Œé‚£ä¹ˆç°åœ¨æˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¼˜åŒ–ç®—æ³•é€‰æ‹©ä»å˜åˆ†æ—ä¸­é€‰æ‹©åˆé€‚çš„åˆ†å¸ƒã€‚**åæ ‡ä¸Šå‡å¹³å‡åœºå˜åˆ†æ¨ç†**(Coordinate ascent mean-field variational inference, CAVI)é€šè¿‡å›ºå®šå˜åˆ†åˆ†å¸ƒçš„å…¶ä»–å˜åˆ†å› å­ï¼Œè¿­ä»£ä¼˜åŒ–æ¯ä¸€ä¸ªå˜åˆ†å› å­ï¼ŒCAVIç®—æ³•æè¿°å¦‚ä¸‹å›¾ï¼š

![sc_8](/Users/changxin/Pictures/SceenShots/sc_8.png)

è¿›ä¸€æ­¥ç†è§£ä¼˜åŒ–è¿‡ç¨‹å¯å‚é˜…é™„å½•[VIæ±‚è§£é«˜æ–¯æ··åˆæ¨¡å‹](#VIæ±‚è§£æ··åˆé«˜æ–¯æ¨¡å‹)ã€‚





å®šä¹‰å…³äºå‚æ•°$\theta$çš„åéªŒæ¦‚ç‡åˆ†å¸ƒï¼š
$$
\begin{split}
p(\theta|X,Y,\alpha) 
&= \cfrac{p(\theta|\alpha)p(Y|X,\theta)}{\int_{\hat \theta}p(\hat\theta|\alpha)p(Y|X,\hat \theta)d\hat \theta}\\\\
&=\cfrac{p(\theta,Y|X,\alpha)}{p(Y|X,\alpha)}
\end{split}
$$
å…¶ä¸­$\alpha$æ˜¯$\theta$çš„å…ˆéªŒåˆ†å¸ƒ,åŒæ—¶è®°çœŸå®åˆ†å¸ƒä¸º$q(\theta|\phi)$,åˆ™ä½¿ç”¨KL Divergenceæ¥è¡¡é‡è¿‘ä¼¼åˆ†å¸ƒå’ŒçœŸå®åéªŒæ¦‚ç‡åˆ†å¸ƒçš„è¯ï¼Œå¯ä»¥è¡¨è¾¾ä¸ºï¼š
$$
\begin{split} 
D_{KL}(q(\theta|\phi)||p(\theta|X,Y,\alpha) )
&=E_{q(\theta|\phi)}[log\cfrac{q(\theta|\phi)}{p(\theta|X,Y,\alpha) }]\\\\
&= F(D,\phi)+log\ p(Y|X,\alpha)
\end{split}
$$

- [ ] $F(D,\phi)â€‹$,å˜åˆ†è‡ªç”±èƒ½é‡çš„æ„ä¹‰æ˜¯ä»€ä¹ˆ

è®¸å¤šæ¦‚ç‡æ¨¡å‹ç”±æœªå½’ä¸€åŒ–çš„æ¦‚ç‡åˆ†å¸ƒ$\hat p(x;\theta)$å®šä¹‰ï¼Œå¿…é¡»é€šè¿‡é™¤ä»¥é…åˆ†å‡½æ•°æ¥å½’ä¸€åŒ–$\hat p$,ä»¥è·å¾—ä¸€ä¸ªæœ‰æ•ˆçš„æ¦‚ç‡åˆ†å¸ƒã€‚

> é…åˆ†å‡½æ•°ï¼šæ˜¯æœªå½’ä¸€åŒ–æ¦‚ç‡æ‰€æœ‰çŠ¶æ€çš„ç§¯åˆ†$\int\hat p(x)dx$ï¼ˆè¿ç»­å˜é‡ï¼‰æˆ–æ±‚å’Œ$\sum_x\hat p(x)$ï¼ˆç¦»æ•£å˜é‡ï¼‰,è€Œå¯¹äºå¾ˆå¤šæœ‰è¶£çš„æ¨¡å‹æ¥è¯´ï¼Œä»¥ä¸Šç§¯åˆ†æˆ–æ±‚å’Œéš¾ä»¥è®¡ç®—ã€‚

é€šè¿‡æœ€å¤§ä¼¼ç„¶å­¦ä¹ æ— å‘æ¨¡å‹ç‰¹åˆ«å›°éš¾çš„åŸå› åœ¨äºé…åˆ†å‡½æ•°çš„è®¡ç®—ä¾èµ–äºå‚æ•°ã€‚



### MCMC

> é©¬å°”å¯å¤«é“¾è’™ç‰¹å¡ç½—æŒ‡ä»æ¦‚ç‡åˆ†å¸ƒä¸­æŠ½æ ·ä»¥æ„å»ºä¸€ä¸ªæ”¶æ•›åˆ°ç›®æ ‡åˆ†å¸ƒçš„æœ€å¤§å¯èƒ½åˆ†å¸ƒçš„ä¸€ç±»æ–¹æ³•ã€‚
>
> æ–¹æ³•åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œè’™ç‰¹å¡ç½—æŒ‡çš„æ˜¯ä½¿ç”¨é‡å¤éšæœºæ ·æœ¬è·å¾—æ•°å€¼è§£çš„ä¸€èˆ¬æ€§æŠ€æœ¯ã€‚è’™ç‰¹å¡ç½—å¯ä»¥è¢«è§†ä¸ºè¿›è¡Œäº†è‹¥å¹²æ¬¡å®éªŒï¼Œå…¶ä¸­æ¯æ¬¡éƒ½å¯¹æ¨¡å‹ä¸­çš„å˜é‡è¿›è¡Œæ”¹å˜å¹¶è§‚å¯Ÿå…¶å“åº”ï¼›
>
> é©¬å°”ç§‘å¤«é“¾æ˜¯ä¸€ä¸ªéšæœºè¿‡ç¨‹ï¼Œå…¶ä¸­æ¬¡æ€ä»…ä¾èµ–äºå½“å‰çŠ¶æ€ï¼›ç»¼åˆé©¬å°”ç§‘å¤«é“¾å’Œè’™ç‰¹å¡ç½—çš„æ€æƒ³ï¼ŒMCMCæ˜¯ä¸€ç§åŸºäºå½“å‰å€¼é‡å¤ç»˜åˆ¶æŸä¸€åˆ†å¸ƒå‚æ•°éšæœºå€¼çš„æ–¹æ³•ã€‚æ¯ä¸ªå€¼çš„æ ·æœ¬éƒ½æ˜¯éšæœºçš„ï¼Œä½†æ˜¯å€¼çš„é€‰æ‹©å—é™äºå½“å‰çŠ¶æ€å’Œå‡å®šçš„å‚æ•°å…ˆéªŒåˆ†å¸ƒã€‚MCMC å¯ä»¥è¢«è®¤ä¸ºæ˜¯ä¸€ç§éšæœºæ¸¸èµ°ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­é€æ¸æ”¶æ•›åˆ°çœŸå®åˆ†å¸ƒã€‚

å½“æ— æ³•ç²¾ç¡®è®¡ç®—å’Œæˆ–è€…ç§¯åˆ†ï¼ˆä¾‹å¦‚ï¼Œå’Œå…·æœ‰æŒ‡æ•°æ•°é‡ä¸ªé¡¹ï¼Œä¸”æ— æ³•è¢«ç²¾ç¡®ç®€åŒ–ï¼‰æ—¶ï¼Œé€šå¸¸å¯ä»¥ä½¿ç”¨MCMCé‡‡æ ·æ¥è¿‘ä¼¼å®ƒã€‚è¿™ç§æƒ³æ³•æŠŠå’Œæˆ–è€…ç§¯åˆ†è§†ä½œæŸåˆ†å¸ƒä¸‹çš„æœŸæœ›ï¼Œç„¶åé€šè¿‡ä¼°è®¡å¯¹åº”çš„å¹³å‡å€¼æ¥è¿‘ä¼¼è¿™ä¸ªæœŸæœ›ã€‚ä»¤$s=\sum_x p(x)f(x)=E_p[f(x)]$æˆ–è€…$s=\int p(x)f(x)dx=E_p[f(x)]$ä¸ºæˆ‘ä»¬éœ€è¦ä¼°è®¡çš„å’Œæˆ–è€…ç§¯åˆ†ï¼Œå†™æˆæœŸæœ›çš„å½¢å¼ï¼Œpæ˜¯ä¸€ä¸ªå…³äºéšæœºå˜é‡xçš„æ¦‚ç‡åˆ†å¸ƒï¼ˆæ±‚å’Œæ—¶ï¼‰æˆ–è€…æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼ˆæ±‚ç§¯åˆ†æ—¶ï¼‰ã€‚

ä¸¤ä¸ªé˜¶æ®µ

1. ç£¨åˆè¿‡ç¨‹ï¼Œä»è¿è¡Œé©¬å°”å¯å¤«é“¾å¼€å§‹åˆ°å…¶è¾¾åˆ°å‡è¡¡åˆ†å¸ƒçš„è¿‡ç¨‹
2. ä»å‡è¡¡åˆ†å¸ƒä¸­æŠ½å–æ ·æœ¬åºåˆ—

é€šå¸¸æ— æ³•é€šè¿‡è¡¨è¾¾çŠ¶æ€åºåˆ—ï¼Œè½¬ç§»çŸ©é˜µï¼Œè½¬ç§»çŸ©é˜µç‰¹å¾å€¼æ¥åˆ¤æ–­é©¬å°”å¯å¤«é“¾æ˜¯å¦å·²ç»æ··åˆæˆåŠŸï¼Œåªèƒ½è¿è¡Œä¸€æ®µè¶³å¤Ÿé•¿çš„æ—¶é—´å¹¶é€šè¿‡å¯å‘å¼çš„æ–¹æ³•åˆ¤æ–­æ˜¯å¦æ··åˆæˆåŠŸï¼ˆåŒ…æ‹¬æ‰‹åŠ¨æ£€æŸ¥æ ·æœ¬æˆ–è€…è¡¡é‡å‰åæ ·æœ¬é—´çš„ç›¸å…³æ€§ï¼‰ã€‚

- [ ] MCMCåªé€‚ç”¨äºå°è§„æ¨¡é—®é¢˜ï¼Œvariational Bayes and expectation propagationçš„å‡ºç°ä½¿å¾—MCMCå¯ä»¥åº”ç”¨äºè¾ƒå¤§è§„æ¨¡é—®é¢˜

æ”¶æ•›ï¼š

MCMCçš„ç†è®ºå¯ä»¥è¯æ˜ï¼Œç»è¿‡ä¸€å®šæ¬¡æ•°çš„è¿­ä»£ä¹‹åï¼Œæœ¬æ–¹æ³•ä¸€å®šä¼šæ”¶æ•›çš„ã€‚åœ¨ä¸€å®šçš„è¿­ä»£æ¬¡æ•°åæ‰€å¾—åˆ°çš„ç¨³å®šåˆ†å¸ƒä¼šååˆ†æ¥è¿‘ç›®æ ‡å¯»æ±‚çš„è”åˆåˆ†å¸ƒã€‚

Burn-inï¼šå¾ˆæ˜æ˜¾çš„æœ€åˆçš„ä¸€äº›è¿­ä»£å¾—åˆ°çš„åˆ†å¸ƒä¼šå’Œç›®æ ‡çš„åéªŒåˆ†å¸ƒå·®è·å¾ˆè¿œï¼Œå› è€Œå‰Nè½®çš„è¿­ä»£åŸºæœ¬æ˜¯å¯ä»¥ç›´æ¥å‰”é™¤çš„ã€‚

> é©¬å°”å¯å¤«é“¾åŠå…¶å¹³ç¨³åˆ†å¸ƒ
>
> æ•°å­¦å®šä¹‰ï¼š
> $$
> \begin{split}
> \Pr(X_{{n+1}}=x\mid X_{1}
> =x_{1},X_{2}=x_{2},\ldots ,X_{n}=x_{n})\\\\
> =\Pr(X_{{n+1}}=x\mid X_{n}=x_{n})
> \end{split}
> $$
> å³çŠ¶æ€è½¬ç§»çš„æ¦‚ç‡åªä¾èµ–äºå‰ä¸€ä¸ªçŠ¶æ€ï¼Œè¿™ç§â€œæ— è®°å¿†æ€§â€ç§°ä¸ºé©¬å°”å¯å¤«æ€§è´¨ã€‚
>

#### å‡ ç§å¸¸ç”¨çš„MCMCé‡‡æ ·æ–¹å¼

##### é‡è¦é‡‡æ ·ï¼š

ç›®å‰çš„ç†è§£æ˜¯é’ˆå¯¹å¤æ‚çš„æ±‚å’Œæˆ–è€…ç§¯åˆ†åˆ†è§£å‡ºæ°å½“çš„pxå’Œfxï¼Œå­¦ä¹ çš„æœ€å¥½çš„æ–¹å¼æ˜¯æœ‰ä¸€ä¸ªå…¸å‹çš„é‡è¦é‡‡æ ·çš„ä¾‹å­ã€‚

Metropolis_Hastings

##### Gibbsé‡‡æ ·ï¼š

**Gibbsé‡‡æ ·æ˜¯æœ€å¸¸ç”¨çš„MCMCé‡‡æ ·æ–¹æ³•**

- [ ] å¯¹æ¯ä¸€ä¸ªéšæœºå˜é‡äº§ç”Ÿä¸€ä¸ªåéªŒæ¡ä»¶åˆ†å¸ƒ
- [ ] ä»ç›®æ ‡åéªŒè”åˆåˆ†å¸ƒä¸­æ¨¡æ‹ŸåéªŒæ ·æœ¬ï¼Œå¯¹æ¯ä¸€ä¸ªéšæœºå˜é‡ä»å…¶å®ƒå˜é‡å›ºå®šä¸ºå½“å‰å€¼çš„åéªŒæ¡ä»¶åˆ†å¸ƒä¸­é‡å¤åœ°é‡‡æ ·

 **Gibbsé‡‡æ ·çš„å±€é™æ€§**ï¼š

1. å³ä½¿å¾—åˆ°å®Œå…¨çš„åéªŒè”åˆå¯†åº¦å‡½æ•°ï¼Œå¾ˆå¤šæƒ…å†µä¸‹å¾ˆæ˜¯éš¾ä»¥å¾—åˆ°æ¯ä¸€ä¸ªéšæœºå˜é‡çš„æ¡ä»¶åˆ†å¸ƒæ¦‚ç‡ï¼›
2. å†é€€ä¸€æ­¥ï¼Œå³ä½¿å¾—åˆ°æ¯ä¸€ä¸ªå˜é‡çš„åéªŒæ¡ä»¶åˆ†å¸ƒï¼Œå¯èƒ½ä¹Ÿä¸æ˜¯æŸç§å·²çŸ¥çš„åˆ†å¸ƒå½¢å¼ï¼Œæ— æ³•ä»ä¸­ç›´æ¥è¿›è¡Œé‡‡æ ·ï¼›
3. GIbbsé‡‡æ ·å¯èƒ½ä¸é€‚åˆæŸäº›åº”ç”¨åœºæ™¯ï¼Œæ•ˆç‡éå¸¸ä½ã€‚

**Gibbsé‡‡æ ·åˆ†æ**
$$
E[f(s)]_p\approx = \cfrac{1}{N}\sum_{i=1}^Nf(s^{(i)})
$$
å¼ä¸­pæ˜¯æˆ‘ä»¬ç›®æ ‡éœ€è¦å¾—åˆ°çš„åéªŒæ¦‚ç‡åˆ†å¸ƒï¼Œf(s)æ˜¯ç›®æ ‡æœŸæœ›ï¼Œ$f(s^{(i)})$æ˜¯ä»pä¸­æ¨¡æ‹Ÿé‡‡æ ·çš„ç¬¬$i^{th}$ä¸ªæ ·æœ¬ã€‚ä½†æ˜¯å…³é”®æ˜¯æˆ‘ä»¬å¦‚ä½•ä»åéªŒåˆ†å¸ƒä¸­è·å¾—æ ·æœ¬ï¼Ÿ

GIbbsé‡‡æ ·çš„æ€æƒ³æ˜¯å›ºå®šå…¶ä»–å˜é‡ï¼Œä»è¿™äº›å›ºå®šå‚æ•°ç¡®å®šçš„æ¡ä»¶åˆ†å¸ƒä¸­é‡‡æ ·ã€‚



Gibbsé‡‡æ ·ç®—æ³•ï¼š

$Initialize\ x^{(0)}\sim q(x)$

for iteration i = 1,2,...do

$x_1^{(i)}\sim p(X_1=x_1|X_2=x_2^{(i-1)},X_3=x_3^{(i-1)},...,X_D=x_D^{(i-1)})$

$x_2^{(i)}\sim p(X_2=x_2|X_1=x_1^{(i)},X_3=x_3^{(i-1)},...,X_D=x_D^{(i-1)})$

...

$x_D^{(i)}\sim p(X_D=x_D|X_1=x_1^{(i)},X_2=x_2^{(i-1)},...,X_{D-1}=x_{D-1}^{(i)})$

end for (until convergence)

é’ˆå¯¹æ¯ä¸€ä¸ªå˜é‡éƒ½ç»™å®šä¸€ä¸ªå…ˆéªŒåˆ†å¸ƒ

**ä»ä¸€ä¸ªå®ä¾‹ç†è§£Gibbsé‡‡æ ·ç®—æ³•**ï¼š

å‡è®¾æœ‰ä¸€ä¸ªè§‚æµ‹åºåˆ—ï¼Œå‰nä¸ªæ•°æ®ç±»ä¼¼ ï¼Œåé¢nï½Nç±»ä¼¼ï¼Œå‡è®¾æ•°æ®æœä»Possionåˆ†å¸ƒï¼š


$$
Possion(x;\lambda)=e^{-\lambda}\cfrac{\lambda^x}{x!}=exp(x\log\lambda-\lambda-\log(x!))
$$
åˆ†å¸ƒçš„å‡å€¼$\lambda$æœä»Gammaåˆ†å¸ƒï¼š
$$
Gamma(\lambda;a,b)=\cfrac{1}{\tau(a)}b^a\lambda^{a-1}\exp(-b\lambda)
$$
æ•´ä¸ªç”Ÿæˆæ¨¡å‹å¯ä»¥å®šä¹‰å¦‚ä¸‹ï¼š

$n\sim Uniform(1,2,3,...N)$

$\lambda_i\sim Gamma(\lambda_i;a,b)$

$x_i\sim\lbrace_{Possion(x_i;\lambda_2) n < i \le N}^{Possion(x_i;\lambda_2)1\le i \le n}$

å¯¹äºéšå˜é‡$n,\lambda_1,\lambda_2$çš„åéªŒæ¦‚ç‡åˆ†å¸ƒå¯ä»¥ç”¨Bayeså…¬å¼æ±‚è§£ï¼š
$$
p(n,\lambda_1,\lambda_2|x_{1:N})\propto p(x_{1:n}|\lambda_1)p(x_{n+1:N}|\lambda_2)p(\lambda_1)p(\lambda_2)p(n)
$$

$$
x_i\sim\{_{Possion(x_i;\lambda_2) n < i \le N}^{Possion(x_i;\lambda_2)1\le i \le n}
$$



## VAEå’ŒGANä¼˜åŒ–ç›®æ ‡åŠå‚æ•°ä¼°è®¡

æ˜¯å¦è¿˜è®°å¾—æˆ‘ä»¬æœ€åˆçš„ç›®æ ‡ï¼Œå¥½äº†ï¼Œä»VIå’ŒMCMCçš„ä¸–ç•Œå›æ¥å§ã€‚

æ ¹æ®é‡è¦é‡‡æ ·(importance sampling)ï¼Œå½“æˆ‘ä»¬éœ€è¦å¯¹åŸå§‹ï¼ˆåä¹‰åˆ†å¸ƒ$p(z)$ï¼‰æ¦‚ç‡å¯†åº¦åˆ†å¸ƒ(pdf)ä¼°ç®—ä¸€ä¸ªæœŸæœ›å€¼æ—¶ï¼ŒISä½¿å¾—æˆ‘ä»¬å¯ä»¥ä»å¦ä¸€ä¸ªä¸åŒçš„æ¦‚ç‡åˆ†å¸ƒï¼ˆå»ºè®®åˆ†å¸ƒï¼‰ä¸­æŠ½æ ·ï¼Œç„¶åå°†è¿™äº›æ ·æœ¬å¯¹åä¹‰åˆ†å¸ƒæ±‚æœŸæœ›

$q_\phi(z|x)$è¡¨ç¤ºå»ºè®®åˆ†å¸ƒï¼Œå‚æ•°$\phi$ç”±å‚æ•°ä¸º$\phi\in\Phi$çš„ç¥ç»ç½‘ç»œç¡®å®šï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼š
$$
\begin{split}
p_\theta(x) 
&= \int p( z)p_\theta(x|z)d z\\\\
&=E_{p(z)}[p_\theta(x|z)]\\\\
&=E_{p(z)}[\cfrac{q_\phi(z|x)}{q_\phi(z|x)}p_\theta(x|z)]\\\\
&=E_{q_\phi(z|x)}[\cfrac{p_\theta(x|z)p(z)}{q_\phi(z|x)}]
\end{split}
$$
PSğŸ˜•

- [ ] è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜è¿˜æ²¡æœ‰ç†æ¸…æ¥š

å…¶å®è¿˜æœ‰å¦ä¸€ç§åéªŒæ¦‚ç‡çš„è¡¨è¾¾æ–¹å¼ 

å¦‚æœè¯´ä¸Šé¢è¡¨è¾¾çš„zæ˜¯éšå˜é‡ï¼Œé‚£ä¹ˆè¿™é‡Œéœ€è¦æ±‚è§£çš„$\theta$æ€ä¹ˆè¡¨è¾¾
$$
p(\theta|x,t) = \cfrac{p(t|x,\theta)p(\theta)}{\int p(t|x,\theta)p(\theta)d\theta}
$$
MLEçš„è§’åº¦ï¼ŒåŸºäºè§‚æµ‹æ•°æ®tï¼Œå¾—åˆ°ä¼¼ç„¶å‡½æ•°$\mathbb L(\theta|t,x)$æœ€å¤§æ—¶$\theta$çš„å–å€¼ï¼Œå¯¹äºå›å½’é—®é¢˜ï¼Œtæ˜¯æ¦‚ç‡åˆ†å¸ƒçš„è‡ªå˜é‡ï¼ˆè‡ªå˜é‡å¸¦å…¥**ç”±xå’Œ$\theta$å…±åŒç¡®å®š**çš„æ¦‚ç‡åˆ†å¸ƒå¾—åˆ°æ¦‚ç‡çš„å€¼ï¼‰ï¼Œå¯¹äºåˆ†ç±»é—®é¢˜ï¼Œtæ˜¯æ˜¯å¦æ­£ç¡®åˆ†ç±»çš„æ ‡è®°ï¼Œå¦‚æœæ˜¯æ­£ç¡®åˆ†ç±»ï¼Œåˆ™å–æ­£ç¡®åˆ†ç±»æ‰€å¯¹åº”çš„æ¦‚ç‡ä»£å…¥ä¼¼ç„¶å‡½æ•°ä¸­ã€‚

- [ ] ç„¶è€Œå¯¹æ¯”æœ¬æ–‡å¯¹éšå˜é‡Zçš„è®¾å®šï¼Œ$\theta$ç¬é—´å¤±å»äº†åœ¨åŸæœ¬ä½“ç³»ä¸­çš„ä½ç½®ï¼Œå…ˆéªŒ$p(z)$å’Œå…ˆéªŒ$p(\theta)$å„è‡ªè¯¥å¦‚ä½•è‡ªå¤„ã€‚æœ¬è¿™äºŒè€…åˆå¹¶ä¸ºzè¿›è¡Œç†è§£æˆ–è®¸å¯è¡Œ,$z = \theta+pre\_z$
- [ ] å½“ç„¶äº†ï¼Œè¿˜æœ‰EMç®—æ³•ï¼Œè‡ªéš¾ç›¸å¿˜



## é™„å½•

### ä¿¡æ¯è®º

> åº”ç”¨æ•°å­¦åˆ†æ”¯ï¼Œç ”ç©¶å¯¹ä¸€ä¸ªä¿¡å·åŒ…å«ä¿¡æ¯çš„å¤šå°‘è¿›è¡Œé‡åŒ–ã€‚æœ€åˆè¢«å‘æ˜ç”¨æ¥ç ”ç©¶åœ¨ä¸€ä¸ªå«æœ‰å™ªå£°çš„ä¿¡é“ä¸Šç”¨ç¦»æ•£çš„å­—æ¯è¡¨æ¥å‘é€ä¿¡æ¯ï¼Œåœ¨æœºå™¨å­¦ä¹ ä¸­ä¸»è¦ä½¿ç”¨ä¿¡æ¯è®ºä¸­çš„ä¸€äº›å…³é”®æ€æƒ³æ¥æè¿°æ¦‚ç‡åˆ†å¸ƒæˆ–è€…é‡åŒ–æ¦‚ç‡åˆ†å¸ƒä¹‹é—´çš„ç›¸ä¼¼æ€§ã€‚

æœ¬å°èŠ‚ä¸»è¦å›é¡¾ä¿¡æ¯è®ºçš„å…³é”®å®šä¹‰ã€‚

1. è‡ªä¿¡æ¯
   $$
   I(x)=-log\ P(x)
   $$
   è‡ªä¿¡æ¯åªå¤„ç†å•ä¸ªä¿¡æ¯çš„è¾“å‡ºï¼Œéœ€è¦é‡åŒ–æ•´ä¸ªæ¦‚ç‡åˆ†å¸ƒä¸­çš„ä¸ç¡®å®šæ€§æ€»é‡çš„è¯ï¼Œä½¿ç”¨é¦™å†œç†µã€‚

2. é¦™å†œç†µ
   $$
   H(x)=\mathbb E_{x\sim P}[I(x)]=-\mathbb E_{x\sim P}[log\ P(x)]
   $$
   äº¦è®°ä½œ$H(P)$.

3. KLæ•£åº¦
   $$
   D_{KL}(P||Q)=\mathbb E_{x\sim P}[log\cfrac{P(x)}{Q(x)}]=E_{x\sim P}[log\ P(x)-log\ Q(x)]
   $$
   åœ¨ç¦»æ•£å‹å˜é‡çš„æƒ…å†µä¸‹ï¼ŒKLæ•£åº¦è¡¡é‡çš„æ˜¯ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨ä¸€ç§è¢«è®¾è®¡æˆèƒ½å¤Ÿä½¿å¾—æ¦‚ç‡åˆ†å¸ƒQäº§ç”Ÿçš„æ¶ˆæ¯é˜Ÿåˆ—é•¿åº¦æœ€å°çš„ç¼–ç ï¼Œå‘é€åŒ…å«ç”±æ¦‚ç‡åˆ†å¸ƒPäº§ç”Ÿçš„ç¬¦å·çš„æ¶ˆæ¯æ—¶(åœ¨æ•°å­¦è¡¨è¾¾$D_{KL}(P||Q)$ä¸­ï¼Œåœ¨å‰çš„åˆ†å¸ƒPç¼–ç ä¿¡é“)ï¼Œæ‰€éœ€è¦çš„é¢å¤–ä¿¡æ¯é‡ã€‚ç®€å•è¡¨è¾¾è¡¡é‡çš„æ˜¯ä¸¤ä¸ªåˆ†å¸ƒä¹‹é—´çš„å·®å¼‚ã€‚

   KLæ•£åº¦æ˜¯éè´Ÿçš„ï¼Œå½“ä¸”ä»…å½“På’ŒQåœ¨ç¦»æ•£å‹éšæœºå˜é‡çš„æƒ…å†µä¸‹æ˜¯ç›¸åŒçš„åˆ†å¸ƒï¼Œæˆ–è€…åœ¨è¿ç»­å‹å˜é‡çš„æƒ…å†µä¸‹å‡ ä¹å¤„å¤„ç›¸åŒã€‚

4. äº¤å‰ç†µ
   $$
   H(P,Q)=H(p)+D_{KL}(P||Q)=-\mathbb E_{x\sim P}log\ Q(x)
   $$






è¿™ä¸€å°èŠ‚æ ¸å¿ƒçš„å†…å®¹åœ¨è¿™é‡Œ:smile:,Klæ•£åº¦ä¸æ˜¯å¯¹ç§°çš„ï¼Œå› è€Œä¸èƒ½ç§°ä½œä¸¤ä¸ªåˆ†å¸ƒé—´çš„è·ç¦»ï¼Œé‚£ä¹ˆè¿™ç§ä¸å¯¹ç§°æ€§å¦‚ä½•ä½“ç°çš„ã€‚

å‡å®šæˆ‘ä»¬æœ‰ä¸€ä¸ªç¡®å®šæ€§åˆ†å¸ƒPï¼Œæˆ‘ä»¬å¸Œæœ›ç”¨å¦ä¸€ä¸ªåˆ†å¸ƒQæ¥è¿‘ä¼¼Pã€‚

è€ƒè™‘ä¸‹é¢ä¸¤å¼çš„ä¸åŒå«ä¹‰
$$
q^* = argmin_{q}KL(p||q)
$$

$$
q^* = argmin_{q}KL(q||p)
$$

![sc_10](/Users/changxin/Pictures/SceenShots/sc_10.png)

åœ¨å·¦å›¾æ‰€ç¤ºçš„ä¼˜åŒ–ç›®æ ‡ä¸­ï¼Œqä½œåˆ†æ¯ï¼Œå› è€Œqä¼šé¿å…å–å¾ˆå°çš„å€¼ï¼›åœ¨å³å›¾ä¸­çš„ä¼˜åŒ–ç›®æ ‡pä½œåˆ†æ¯ï¼Œå› è€Œåœ¨på–å°å€¼çš„æ—¶å€™ï¼Œqä¹Ÿè¦ç›¸åº”çš„å–å°å€¼ï¼Œå› è€Œqçš„å€¼åªèƒ½é›†ä¸­äºæŸä¸€ä¸ªå³°ã€‚

>  åœ¨å†™è¿™ç¯‡æ–‡ç« çš„åŒæ—¶ï¼Œæœ‰ä¸€ç¯‡è®ºæ–‡æå‡ºæ·±åº¦ç”Ÿæˆæ¨¡å‹çš„ç»Ÿä¸€æ¡†æ¶ã€ŠOn Unifying Deep Generative Modelsã€‹ï¼Œæ”¹å†™äº†GANå…³äº$\theta$çš„è¡¨è¾¾ï¼Œ$KL( p_{\theta} ||Q_{\phi_0} ) - JSD_Î¸$ï¼Œå°†$p_{\theta}$çœ‹ä½œå˜åˆ†åˆ†å¸ƒ,$Q_{\phi_0}$çœ‹ä½œçœŸå®åéªŒåˆ†å¸ƒã€‚
>
>  åœ¨æœ€å°åŒ–æ¨æ–­åˆ†å¸ƒå’Œå¯¹åº”çœŸå®åéªŒåˆ†å¸ƒçš„KLæ•£åº¦æ—¶ï¼Œç”Ÿæˆæ¨¡å‹å‚æ•°$\theta$åœ¨KLæ•£åº¦ä¸­çš„ä½ç½®ä¸åŒï¼Œæ•ˆæœä¸åŒï¼š
>
>  GANä¸­ï¼ŒKLæ•£åº¦å€¾å‘äºé©±ä½¿ç”Ÿæˆæ¨¡å‹åˆ†å¸ƒé›†ä¸­é›†ä¸­åˆ°çœŸå®åéªŒåˆ†å¸ƒçš„å°‘æ•°å‡ ä¸ªé«˜å¯†åº¦åŒºåŸŸï¼Œè¿™ä½¿å¾— GAN é€šå¸¸èƒ½å¤Ÿç”Ÿæˆæ¸…æ™°å›¾åƒï¼Œä½†æ˜¯ç¼ºå°‘æ ·æœ¬å¤šæ ·æ€§
>
>  å¯¹æ¯”æ¥çœ‹ï¼ŒVAE ä¸­çš„ KL æ•£åº¦($KL(q(z|x;\phi)||p(z|x;\theta))$)ä¼šé©±ä½¿ç”Ÿæˆæ¨¡å‹åˆ†å¸ƒè¦†ç›–çœŸå®åéªŒåˆ†å¸ƒçš„æ‰€æœ‰åŒºåŸŸï¼ŒåŒ…æ‹¬çœŸå®åéªŒåˆ†å¸ƒçš„ä½å¯†åº¦åŒºåŸŸï¼Œè¿™é€šå¸¸å¯¼è‡´ç”Ÿæˆæ¨¡ç³Šå›¾åƒã€‚

## æ··åˆé«˜æ–¯æ¨¡å‹

[ç¼ºç‚¹](http://sklearn.apachecn.org/cn/stable/modules/mixture.html)ï¼š

- å¥‡å¼‚æ€§

  å½“æ¯ä¸ªæ··åˆæ¨¡å‹æ²¡æœ‰è¶³å¤Ÿå¤šçš„ç‚¹æ—¶ï¼Œä¼°ç®—åæ–¹å·®å˜éš¾ï¼ŒåŒæ—¶ç®—æ³•ä¼šå‘æ•£å¹¶ä¸”æ‰¾å…·æœ‰æ— ç©·å¤§ä¼¼ç„¶å‡½æ•°å€¼çš„è§£ï¼Œé™¤éè®¤ä¸ºçš„è¿›è¡Œæ­£åˆ™åŒ–ã€‚

- åˆ†é‡çš„æ•°é‡

  è¿™ä¸ªç®—æ³•å°†ä¼šæ€»æ˜¯ç”¨æ‰€æœ‰å®ƒèƒ½ç”¨çš„åˆ†é‡ï¼Œæ‰€ä»¥åœ¨æ²¡æœ‰å¤–éƒ¨çº¿ç´¢çš„æƒ…å†µä¸‹éœ€è¦ç•™å­˜æ•°æ®æˆ–è€…ç”¨ä¿¡æ¯ç†è®ºæ ‡å‡†æ¥å†³å®šç”¨å¤šå°‘åˆ†é‡ã€‚

å•å˜é‡ï¼Œå¤šå˜é‡

## EMç®—æ³•

> æ˜¯å˜åˆ†æ¨ç†çš„åŸºç¡€

![sc_11](/Users/changxin/Pictures/SceenShots/sc_11.png)

![sc_12](/Users/changxin/Pictures/SceenShots/sc_12.png)



### VIæ±‚è§£æ··åˆé«˜æ–¯æ¨¡å‹

Kä¸ªç‹¬ç«‹çš„æ­£æ€åˆ†å¸ƒæ··åˆï¼Œç»™å‡ºè§‚æµ‹æ•°æ®{x_n},n=1,2,...,N,æˆ‘éœ€è¦ä¼°è®¡çš„éšå˜é‡æœ‰Kä¸ªæ··åˆæˆåˆ†ä¸ªå„è‡ªçš„å‡å€¼$\boldsymbol\mu=\mu_{1:K}$å’Œè§‚æµ‹çš„æ¥æºåˆ†å¸ƒ$\boldsymbol c=\mu_{1:n}$,é—®é¢˜å¯ä»¥å®šä¹‰å¦‚ä¸‹ï¼š
$$
\begin{split}
\boldsymbol{\mu} = \{\mu_1, ..., \mu_K\}\hspace{2cm}  \\\\
\mu_k \sim \mathcal{N}(0, \sigma^{2}), \hspace{1cm} k = 1, ..., K \\\\
c_i \sim Categorical(\frac{1}{K}, ..., \frac{1}{K}), \hspace{1cm} i = 1, ..., n \\\\
x_i \vert c_i, \boldsymbol{\mu} \sim \mathcal{N}(c_i^T\boldsymbol{\mu}, 1), \hspace{1cm} i = 1, ..., n 
\end{split}
$$
è§‚æµ‹å’Œéšå˜é‡çš„è”åˆåˆ†å¸ƒå¯ä»¥è¡¨è¾¾ä¸ºï¼š
$$
p(\boldsymbol{\mu, c, x}) = p(\boldsymbol{\mu})\boldsymbol{\prod_{i=1}^{n}}p(c_i)p(x_i \vert c_i,\boldsymbol{\mu})
$$
è¯æ®$p(x)$å¯ä»¥è¡¨è¾¾ä¸ºï¼š
$$
p(\boldsymbol{x}) = \int d\boldsymbol{\mu} p(\boldsymbol{\mu})\prod_{i=1}^n \sum_{c_i} p(c_i) p(x_i \vert c_i, \boldsymbol{\mu})
$$
ä¸‹é¢æˆ‘ä»¬ä»å¹³å‡åœºåˆ†å¸ƒæ—ä¸­é€‰å–åˆ†å¸ƒè¿‘ä¼¼å…³äºéšå˜é‡çš„åéªŒæ¦‚ç‡åˆ†å¸ƒï¼š
$$
q(\boldsymbol{\mu, c}) = \boldsymbol{\prod_{k=1}^K} q(\mu_k;m_k, s_k^2)\boldsymbol{\prod_{i=1}^n}q(c_i;w_i)
$$
éšå˜é‡$\mu,c$åˆ†åˆ«æœ‰ä¸åŒçš„å˜åˆ†å› å­ï¼Œå…¶ä¸­$\mu$ç”±è‡ªå·±çš„å‡å€¼å’Œæ–¹å·®å†³å®šï¼Œä»£å…¥ELBOå¯å¾—ï¼š
$$
ELBO(q) = E[(log(p(z,x))] - E[log(q(z))] \\\\
\implies ELBO(\boldsymbol{m,s^2,w}) = \sum_{k=1}^{K}E[log(p(\mu_k));m_k,s_k^2] \\\\
+ \sum_{i=1}^n(E[log(p(c_i));w_i] + E[log(p(x_i \vert c_i,\boldsymbol{\mu}));w_i,\boldsymbol{m,s^2}]) \\\\
- \sum_{i=1}^nE[log(q(c_i;w_i))] - \sum_{k=1}^KE[log(q(\mu_k;m_k,s_k^2))]
$$
ä¼˜åŒ–è¿­ä»£è¿‡ç¨‹ï¼š

å›°äºæ­¤æ•´ä¸€å‘¨



1. ä¼°è®¡$\boldsymbol c$ï¼š
   $$
   q^*(c_i;w_i) \propto \exp\{log(p(c_i)) + E_{-z_i}[log(p(x_i \vert c_i,\boldsymbol{\mu}));\boldsymbol{m,s^2}]\}
   $$
   å…¬å¼å³è¾¹æŒ‡æ•°çš„ç¬¬ä¸€é¡¹æ˜¯cçš„å…ˆéªŒ$log(p(c_i)) = log(\frac{1}{K})$ï¼Œç¬¬äºŒé¡¹æ˜¯ç¬¬c_iä¸ªé«˜æ–¯å¯†åº¦çš„å¯¹æ•°æœŸæœ›ï¼š
   $$
   p(x_i \vert c_i,\boldsymbol{\mu}) = \prod_{k=1}^Kp(x_i \vert \mu_{k})^{c_{ik}}
   $$
   åˆ™ï¼š
   $$
   \begin{split}
   E[log(p(x_i \vert c_i,\boldsymbol{\mu}))] &= \sum_kc_{ik}E[log(p(x_i \vert \mu_k));m_k,s_k^2] \\\\
   &= \sum_kc_{ik}E[-(x_i-\mu_k)^2/2;m_k,s_k^2] + const \\\\
   &=\sum_kc_{ik}(E[\mu_k;m_k,s_k^2]x_i - E[\mu_k^2;m_k,s_k^2]/2) + const
   \end{split}
   $$

2. ä¼°è®¡$\boldsymbol \muâ€‹$:

   

## reference

- [https://am207.github.io/2017/wiki/VI.html#elbo---evidence-lower-bound---objective-function-to-be-optimized](https://am207.github.io/2017/wiki/VI.html#elbo---evidence-lower-bound---objective-function-to-be-optimized)
- [http://akosiorek.github.io/ml/2018/03/14/what_is_wrong_with_vaes.html](http://akosiorek.github.io/ml/2018/03/14/what_is_wrong_with_vaes.html)
- [https://www.jeremyjordan.me/variational-autoencoders/](https://www.jeremyjordan.me/variational-autoencoders/)
- [http://www.zhuanzhi.ai/document/86e444230724b62b3cd9442fb8bccab0](http://www.zhuanzhi.ai/document/86e444230724b62b3cd9442fb8bccab0)





å¾…å‚é˜…çš„èµ„æ–™ï¼š

bleiçš„LDAè®ºæ–‡çš„é™„å½•ï¼Œå…¶ä¸­ä¾¿æ˜¯ç”¨mean-fieldåšå˜åˆ†æ¨ç†çš„ï¼Œå¹¶ä¸”æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„LDAå˜åˆ†EMçš„ç®—æ³•æ¨å¯¼ã€‚Latent Dirichlet Allocation ï¼ˆLDAï¼‰- David M.Blei



# prml

## ç»ªè®º

$$
\begin{split}
var[f]&=E[(f(x)-E[f(x)])^2] \\\\
&=E[f(x)^2]-E[f(x)]^2
\end{split}
$$

é«˜æ–¯åˆ†å¸ƒï¼š



![sc_14](/Users/changxin/Pictures/SceenShots/sc_14.png)
$$
N(x|\mu,\sigma^2)=\cfrac{1}{(2\pi\sigma^2)^{1/2}}exp^{-\cfrac{1}{2\sigma^2}(x-\mu)^2}
$$
ä¼¼ç„¶å‡½æ•°ï¼š



å¯¹æ•°ä¼¼ç„¶å‡½æ•°ï¼š
$$
<Empty \space Math \space Block>
$$
![sc_15](/Users/changxin/Pictures/SceenShots/sc_15.png)

æœ€å¤§ä¼¼ç„¶çš„è¿ç§»é—®é¢˜æ˜¯æˆ‘ä»¬åœ¨å¤šé¡¹å¼æ›²çº¿æ‹Ÿåˆé—®é¢˜ä¸­é‡åˆ°çš„è¿‡æ‹Ÿåˆé—®é¢˜çš„æ ¸å¿ƒ

è´å¶æ–¯ä¿¡æ¯å‡†åˆ™





é’ˆå¯¹æ•°æ®çš„å»ºæ¨¡è¿‡ç¨‹ï¼ŒåŸºäºæ¦‚ç‡åˆ†å¸ƒçš„å»ºæ¨¡è¿‡ç¨‹ï¼Œéƒ½æ˜¯æœ€åè§£é‡Šæˆäº†ç»Ÿè®¡æœºå™¨å­¦ä¹ ï¼Œå‘æŒ¥çš„æ·‹æ¼“å°½è‡´çš„å°±æ˜¯graphicÂ model

æ—¢ç„¶éƒ½æœ‰ç»Ÿè®¡è§£é‡Šï¼Œä¸ºä»€ä¹ˆä¸ç›´æ¥ä»ç»Ÿè®¡ä¸Šç›´æ¥å»ºæ¨¡ï¼Œç”Ÿæˆæ¨¡å‹



- [ ] å›å½’åˆ†æï¼Œå‡è®¾æ£€éªŒï¼Œp-value
- [ ] AICï¼Œæœ€å°ä¿¡æ¯å‡†åˆ™ 
- [ ] æ–‡æœ¬è¡¥ç¼º
- [ ] æ¨èç®—æ³•
- [ ] æœ€å°ä¸€ä¹˜ï¼ŒLDA
- [ ] ä¸ºä»€ä¹ˆè¯´æœºå™¨å­¦ä¹ ä¸å•å•æ˜¯ä¸€ä¸ªæ‹Ÿåˆé—®é¢˜
- [ ] æ–¹å·®çš„å€’æ•°-ç²¾åº¦



äºŸå¾…è§£å†³çš„é—®é¢˜

- [ ] å­¦ä¹ ç‡é€‰æ‹©æŠ€å·§ï¼Œç¡®ä¿ç®—æ³•æ”¶æ•›
- [ ] æ­£åˆ™åŒ–ç³»æ•°é€‰æ‹©æŠ€å·§
- [ ] æ¢å¤éƒ¨åˆ†å‚æ•°
- [ ] tensorboardä½¿ç”¨æŠ€å·§
- [ ] æ·»åŠ æµ‹è¯•è¯¯å·®
- [ ] ä½¿ç”¨åˆ†å¸ƒå¼tensorflow
- [ ] momentum
- [ ] æ±‡æ€»5é“tensorflowè®­ç»ƒé¢˜
- [ ] 





Tensorflowè®­ç»ƒæŠ€å·§



Gammaå‡½æ•°ï¼š
$$
\Gamma(x)\equiv\int_{0}^{\propto}u^{x-1}e^{-u}du
$$


åéªŒ=å…ˆéªŒ+æ•°æ®ï¼ˆä¼¼ç„¶ä¼°è®¡ï¼‰



å‡è®¾tæœä»ä¸wå’Œxæœ‰å…³çš„é«˜æ–¯åˆ†å¸ƒï¼Œé‚£ä¹ˆè‡ªç„¶tå–é«˜æ–¯åˆ†å¸ƒæ¦‚ç‡æœ€é«˜æ—¶çš„å–å€¼ï¼Œå³é«˜æ–¯åˆ†å¸ƒçš„å‡å€¼å¤„ï¼›

å¦‚ä½•æ¨å¹¿åˆ°æ›´ä¸€èˆ¬çš„åˆ†å¸ƒ



åˆ†ç±»é—®é¢˜ï¼Œç›®æ ‡å˜é‡çš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒå°±æ˜¯ä¼¯åŠªåˆ©åˆ†å¸ƒï¼Œè€ƒè™‘ä¸€ä¸ªç”±ç‹¬ç«‹çš„è§‚æµ‹ç»„æˆçš„è®­ç»ƒé›†ï¼Œè´Ÿå¯¹æ•°ä¼¼ç„¶å‡½æ•°çš„ç»™å‡ºçš„è¯¯å·®å‡½æ•°å°±æ˜¯äº¤å‰ç†µè¯¯å·®å‡½æ•°





